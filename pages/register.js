import { useState } from 'react'; import Layout from '@/components/Layout'
export default function Register(){ const [username,setUser]=useState(''); const [password,setPass]=useState(''); const [avatar,setAvatar]=useState(''); const [banner,setBanner]=useState(''); const [msg,setMsg]=useState('')
const submit=async(e)=>{ e.preventDefault(); const res = await fetch('/api/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username,password})}); const data = await res.json(); if(data.success){ const local = JSON.parse(localStorage.getItem('localUsers')||'[]'); local.push({username,password,role:'user',verified:false,avatar:avatar||'/default-avatar.png',banner:banner||'',followers:0}); localStorage.setItem('localUsers', JSON.stringify(local)); // store profiles
const profiles = JSON.parse(localStorage.getItem('localProfiles')||'[]'); profiles.push({username,avatar:avatar||'/default-avatar.png',banner:banner||''}); localStorage.setItem('localProfiles', JSON.stringify(profiles)); setMsg('Register berhasil! Silakan login.'); setTimeout(()=>location.href='/login',900); }else setMsg('Register gagal') }
return (<Layout><div className='container py-16'><div className='max-w-md mx-auto card'><h1 className='text-2xl font-bold'>Register</h1><form onSubmit={submit} className='mt-4 space-y-3'><input className='w-full border rounded-xl p-2' placeholder='Username' value={username} onChange={e=>setUser(e.target.value)} /><input type='password' className='w-full border rounded-xl p-2' placeholder='Password' value={password} onChange={e=>setPass(e.target.value)} /><input className='w-full border rounded-xl p-2' placeholder='Avatar URL (optional)' value={avatar} onChange={e=>setAvatar(e.target.value)} /><input className='w-full border rounded-xl p-2' placeholder='Banner URL (optional)' value={banner} onChange={e=>setBanner(e.target.value)} /><button className='btn btn-primary w-full'>Daftar</button></form>{msg && <p className='text-sm text-green-600 mt-3'>{msg}</p>}</div></div></Layout>) }
