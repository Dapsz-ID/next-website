import { useEffect, useState } from 'react'; import Layout from '@/components/Layout'
export default function NewSnippet(){ const [title,setTitle]=useState(''); const [code,setCode]=useState(''); const [user,setUser]=useState('')
useEffect(()=> setUser(localStorage.getItem('user')||''),[]); useEffect(()=>{ if(!localStorage.getItem('user')) location.href='/login' },[])
const save=(e)=>{ e.preventDefault(); const id = title.toLowerCase().replace(/[^a-z0-9]+/g,'-')||'snip-'+Date.now(); const sn={id,title,author:user||'guest',code,likes:0,views:0,comments:[]}; const arr=JSON.parse(localStorage.getItem('snippets')||'[]'); arr.push(sn); localStorage.setItem('snippets',JSON.stringify(arr)); location.href='/codeshare/'+id }
return (<Layout><div className='container py-12 max-w-2xl'><h1 className='text-3xl font-bold'>Buat Snippet</h1><form onSubmit={save} className='card mt-4 space-y-3'><input className='w-full border rounded-xl p-2' placeholder='Judul' value={title} onChange={e=>setTitle(e.target.value)}/><textarea className='w-full border rounded-xl p-2 h-64 font-mono bg-black text-white' placeholder='Tulis kode JavaScript' value={code} onChange={e=>setCode(e.target.value)}/><button className='btn btn-primary w-full'>Simpan</button></form></div></Layout>) }
