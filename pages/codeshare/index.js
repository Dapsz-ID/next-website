import { useEffect, useState } from 'react'; import Layout from '@/components/Layout'
export default function Codeshare(){ const [snippets,setSnippets]=useState([])
useEffect(()=>{ const local = JSON.parse(localStorage.getItem('snippets')||'[]'); fetch('/api/snippets').then(r=>r.json()).then(seed=>{ const merged = [...seed.filter(s=>!(JSON.parse(localStorage.getItem('removedSeed')||'[]').includes(s.id))), ...local.filter(l=>!seed.find(s=>s.id===l.id))]; setSnippets(merged) }).catch(()=>setSnippets(local)) },[])
return (<Layout><div className='container py-12'><div className='flex items-center justify-between'><h1 className='text-3xl font-bold'>Codeshare</h1><a href='/codeshare/new' className='btn btn-primary'>+ New Snippet</a></div><div className='grid md:grid-cols-2 gap-6 mt-8'>{snippets.map(s=>(<a key={s.id} href={'/codeshare/'+s.id} className='card block'><div className='flex items-center justify-between'><h3 className='text-xl font-semibold'>{s.title}</h3><span className='text-sm text-gray-500'>@{s.author}</span></div><div className='text-sm text-gray-600 mt-2 flex gap-4'><span>👁️ {s.views||0}</span><span>❤️ {s.likes||0}</span></div></a>))}</div></div></Layout>) }
